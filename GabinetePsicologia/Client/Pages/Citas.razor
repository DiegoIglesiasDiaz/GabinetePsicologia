@page "/Citas"
@using GabinetePsicologia.Shared

<style>

    .content-table {
        border-collapse: collapse;
        margin: 25px 0;
        font-size: 0.9em;
        min-width: 400px;
        border-radius: 5px 5px 0 0;
        overflow: hidden;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
    }

        .content-table thead tr {
            background-color: #1543f6;
            color: #ffffff;
            text-align: left;
            font-weight: bold;
        }

        .content-table th,
        .content-table td {
            padding: 12px 15px;
        }

        .content-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }

            .content-table tbody tr:nth-of-type(even) {
                background-color: #f3f3f3;
            }

            .content-table tbody tr:last-of-type {
                border-bottom: 2px solid #1543f6;
            }

            .content-table tbody tr.active-row {
                font-weight: bold;
                color: #1543f6;
            }
</style>
@if (isInRole)
{
    <div class="d-flex flex-column align-items-center justify-content-center ">
        <h3>Citas</h3>
        <br>

        @if (ProximasCitas.Count > 0)
        {
            <h5>Próximas Citas</h5>
            <div>
                <table class="content-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Hora</th>
                            @if (isPsicologo || isAdmin)
                            {
                                <th>Paciente</th>
                            }
                            @if (isPaciente || isAdmin)
                            {
                                <th>Psicólogo</th>
                            }
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var x in ProximasCitas)
                        {
                            <tr>
                                <td>@x.FecInicio.Date.ToShortDateString()</td>
                                <td>@x.FecInicio.ToString("HH:mm") -  @x.FecFin.ToString("HH:mm")</td>
                                @if (isPsicologo || isAdmin)
                                {
                                    <td>@x.Nombre</td>
                                }
                                @if (isPaciente || isAdmin)
                                {
                                    <td>@PsicologoName(x.PsicologoId)</td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <hr style="border: none;width: 65%;height: 2px;opacity:1; background-color:var(--rz-primary);">
        }


        <br>
        <h5>Calendario</h5>
        @* <RadzenDropDown @bind-Value=@value Data=@lsPsicologos TextProperty="Nombre" ValueProperty="Nombre" />*@
        <div>
            @if (isAdmin)
            {
                <RadzenDropDown TValue="GabinetePsicologia.Shared.Psicologo" Data=@lsPsicologos FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive" FilterOperator="StringFilterOperator.Contains" AllowFiltering="true"
                        TextProperty="FullName" ValueProperty="Id" AllowClear=true Placeholder="Selecciona un Psicólogo" Change="@change" />
            }
            @if (isPsicologo || isAdmin)
            {
                <RadzenDropDown TValue="GabinetePsicologia.Shared.Paciente" Data=@lsPacientes FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive" FilterOperator="StringFilterOperator.Contains" AllowFiltering="true"
                        TextProperty="FullName" ValueProperty="Id" AllowClear=true Placeholder="Selecciona un Paciente" Change="@changePaciente"  />
            }

        </div>
        <br /><br />
        <RadzenScheduler @ref=@scheduler Data="@data" TItem="Cita" Style="width:70%"
                     StartProperty="FecInicio" EndProperty="FecFin" TextProperty="Nombre" SelectedIndex="2" TodayText="Hoy" 
                     SlotRender=@OnSlotRender AppointmentRender=@OnAppointmentRender SlotSelect=@OnSlotSelect AppointmentSelect="OnAppointmentSelect">
            <RadzenDayView Text="Dia" />
            <RadzenWeekView Text="Semana" />
            <RadzenMonthView Text="Mes" />
            <RadzenYearView Text="Año" />
        </RadzenScheduler>
        <br>
    </div>
    <br>

}
else
{
    <p>No estas Autorizado para ver esta página.</p>
}
